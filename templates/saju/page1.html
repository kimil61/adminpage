{% extends "base.html" %}

{% block title %}ë¬´ë£Œ AI ì‚¬ì£¼íŒ”ì ë³´ëŠ” ê³³ ğŸ”® | ë‚˜ì˜ 2025ë…„ ìš´ì„¸ í™•ì¸{% endblock %}

{% block extra_head %}
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR&display=swap" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="saju-container max-w-3xl mx-auto bg-white p-8 rounded-xl shadow-lg">
  <h1 class="text-3xl md:text-4xl font-bold text-center text-purple-800 mb-6">ğŸ”® ë‚˜ì˜ ì‚¬ì£¼íŒ”ì í™•ì¸í•˜ê¸°</h1>

  <div class="text-gray-700 text-lg leading-relaxed space-y-6 mb-6">
      <p>
      ì‚¬ì£¼íŒ”ìì˜ ë¿Œë¦¬ëŠ” ë©€ë¦¬ <strong>ë‹¹ë‚˜ë¼</strong>ê¹Œì§€ ê±°ìŠ¬ëŸ¬ ì˜¬ë¼ê°‘ë‹ˆë‹¤.<br>
      ì¸ê°„ì´ ì‚´ì•„ê°€ë©° ê²ªëŠ” ê¸°ì¨ê³¼ ìŠ¬í””, ì„±ê³µê³¼ ë°©í™©ì˜ íë¦„ ì†ì—ì„œ  
      ì‚¬ëŒë“¤ì€ 'ì‹œê°„'ê³¼ 'ê¸°ìš´'ì´ ì‚¶ì— ì–´ë–¤ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ì§€ë¥¼ í†µì°°í•˜ë ¤ í–ˆìŠµë‹ˆë‹¤.
    </p>
    
    <p>
      ê·¸ íë¦„ì€ ì†¡ë‚˜ë¼ì—ì„œ ë”ìš± ì •êµí•´ì¡Œê³ ,  
      <strong>ëª…ë‚˜ë¼</strong>ì—ì„œëŠ” ì´ë¥¼ ì§‘ëŒ€ì„±í•œ ê³ ì „ ã€Š<strong>ä¸‰å‘½é€šä¼š</strong>ã€‹ê°€ íƒ„ìƒí•©ë‹ˆë‹¤.<br>
      ì´ ì±…ì€ ìˆ˜ì²œ ê°œì˜ ì‹¤ì œ ì‚¬ì£¼ ì‚¬ë¡€ë¥¼ í†µí•´  
      ì²œê°„ê³¼ ì§€ì§€ì˜ ì¡°í•©ì´ ì¸ìƒì— ì–´ë–»ê²Œ ì‘ìš©í•˜ëŠ”ì§€ë¥¼ ê¸°ë¡í•œ ëª…ë¦¬í•™ì˜ ë°±ê³¼ì‚¬ì „ì…ë‹ˆë‹¤.
    </p>
    
    <div style="text-align: center; margin: 32px 0;">
      <img src="/static/assets/smth.jpg" alt="ì‚¼ëª…í†µíšŒ ê³ ì„œ ì´ë¯¸ì§€" 
           style="max-width: 100%; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
      <p style="font-size: 14px; color: #777; margin-top: 8px;">
        â–² ëª…ë¦¬í•™ ê³ ì„œ ã€Šä¸‰å‘½é€šä¼šã€‹ ì¼ë¶€ ì´ë¯¸ì§€. ì‹œëŒ€ë¥¼ ë„˜ì–´ ì „í•´ì§€ëŠ” ì§€í˜œ.
      </p>
    </div>
    
    <p style="color: #6a1b9a; font-weight: 600;">
      ì‹œëŒ€ëŠ” ë³€í•´ë„, ì¸ê°„ì˜ ë³¸ì§ˆì€ ë³€í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br>
      ì‚¬ë‘ì— ì„¤ë ˆê³ , ì„ íƒ ì•ì— ë¨¸ë­‡ê±°ë¦¬ë©°,  
      ê´€ê³„ ì†ì—ì„œ ê³ ë¯¼í•˜ëŠ” ë§ˆìŒì€ ìˆ˜ì²œ ë…„ ì „ì´ë‚˜ ì§€ê¸ˆì´ë‚˜ ë‹¤ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.
    </p>
  <form method="post" class="saju-form" id="sajuForm">
    <div class="mb-6">
      <label class="block text-base font-medium text-gray-800 mb-2">ì´ë¦„ (ì„ íƒ)</label>
      <input type="text" name="name" class="w-full p-4 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-600" placeholder="ì´ë¦„ ì…ë ¥ì€ ì„ íƒì‚¬í•­ì…ë‹ˆë‹¤ ğŸ˜Š">
    </div>

    <div class="mb-6">
      <label class="block text-base font-medium text-gray-800 mb-2">ì„±ë³„ *</label>
      <select name="gender" class="w-full p-4 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-600" required>
        <option value="">ì„±ë³„ì„ ì„ íƒí•´ì£¼ì„¸ìš”</option>
        <option value="male">ë‚¨ì</option>
        <option value="female">ì—¬ì</option>
      </select>
    </div>

    <!-- ë‹¬ë ¥ ì„ íƒ (ìƒˆë¡œ ì¶”ê°€) -->
    <div class="mb-6">
        <label class="block text-base font-medium text-gray-800 mb-2">ë‹¬ë ¥ êµ¬ë¶„ *</label>
        <div class="grid grid-cols-2 gap-4">
            <label class="flex items-center p-4 border-2 border-gray-300 rounded-lg cursor-pointer hover:border-purple-400 transition-colors">
                <input type="radio" name="calendar" value="SOL" checked class="mr-3">
                <div>
                    <div class="font-medium">ì–‘ë ¥ ğŸ“…</div>
                    <div class="text-sm text-gray-600">ì¼ë°˜ì ì¸ ë‹¬ë ¥</div>
                </div>
            </label>
            <label class="flex items-center p-4 border-2 border-gray-300 rounded-lg cursor-pointer hover:border-purple-400 transition-colors">
                <input type="radio" name="calendar" value="LUN" class="mr-3">
                <div>
                    <div class="font-medium">ìŒë ¥ ğŸŒ™</div>
                    <div class="text-sm text-gray-600">ì „í†µ ìŒë ¥ ë‚ ì§œ</div>
                </div>
            </label>
        </div>
    </div>

    <div class="mb-6">
      <label class="block text-base font-medium text-gray-800 mb-2">ìƒë…„ì›”ì¼ (ì–‘ë ¥) *</label>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <select name="birth_year" class="w-full p-4 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-600" required id="birthYear">
          <option value="">ë…„ë„</option>
          {% for y in range(1920, 2025) %}
            <option value="{{ y }}" {% if y == default_year %}selected{% endif %}>{{ y }}ë…„</option>
          {% endfor %}
        </select>

        <select name="birth_month" class="w-full p-4 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-600" required id="birthMonth">
          <option value="">ì›”</option>
          {% for m in range(1, 13) %}
            <option value="{{ m }}" {% if m == default_month %}selected{% endif %}>{{ m }}ì›”</option>
          {% endfor %}
        </select>

        <select name="birth_day" class="w-full p-4 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-600" required id="birthDay">
          <option value="">ì¼</option>
          {% for d in range(1, 32) %}
            <option value="{{ d }}" {% if d == default_day %}selected{% endif %}>{{ d }}ì¼</option>
          {% endfor %}
        </select>
      </div>
    </div>

    <!-- ì¶œìƒ ì‹œê°„ (ê°œì„ ) -->
    <div class="mb-6">
        <label class="block text-base font-medium text-gray-800 mb-2">ì¶œìƒ ì‹œê°„ *</label>
        
        <!-- ì‹œê°„ ë¯¸ìƒ ì²´í¬ë°•ìŠ¤ -->
        <div class="mb-3">
            <label class="inline-flex items-center">
                <input type="checkbox" id="hourUnknown" name="hour_unknown" class="rounded border-gray-300 text-purple-600 shadow-sm focus:ring-purple-500">
                <span class="ml-2 text-sm text-gray-700">ì¶œìƒ ì‹œê°„ì„ ëª¨ë¥´ê² ì–´ìš” â°</span>
            </label>
        </div>
        
        <!-- ì‹œê°„ ì„ íƒ -->
        <select name="birthhour" id="birthhourSelect" class="w-full p-4 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-600">
            <option value="">ì¶œìƒ ì‹œê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”</option>
            {% for h in range(0, 24) %}
                <option value="{{ h }}">{{ h }}ì‹œ ({{ h if h <= 12 else h-12 }}{{ "ì˜¤ì „" if h < 12 else "ì˜¤í›„" }})</option>
            {% endfor %}
        </select>
        
        <div class="mt-2 text-sm text-gray-600">
            ğŸ’¡ ì‹œê°„ì„ ëª¨ë¥´ì‹œë©´ ìœ„ì˜ ì²´í¬ë°•ìŠ¤ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”. ì •ì˜¤(12ì‹œ) ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚°ë©ë‹ˆë‹¤.
        </div>
    </div>

    <!-- ì‹œê°„ëŒ€ ì„ íƒ (ìƒˆë¡œ ì¶”ê°€) -->
    <div class="mb-6">
        <label class="block text-base font-medium text-gray-800 mb-2">ì¶œìƒ ì§€ì—­ ì‹œê°„ëŒ€</label>
        <select name="timezone" id="timezoneSelect" class="w-full p-4 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-600">
            <option value="Asia/Seoul">ğŸ‡°ğŸ‡· í•œêµ­ (ì„œìš¸)</option>
            <option value="Asia/Tokyo">ğŸ‡¯ğŸ‡µ ì¼ë³¸ (ë„ì¿„)</option>
            <option value="Asia/Shanghai">ğŸ‡¨ğŸ‡³ ì¤‘êµ­ (ìƒí•˜ì´)</option>
            <option value="America/New_York">ğŸ‡ºğŸ‡¸ ë¯¸êµ­ ë™ë¶€ (ë‰´ìš•)</option>
            <option value="America/Los_Angeles">ğŸ‡ºğŸ‡¸ ë¯¸êµ­ ì„œë¶€ (LA)</option>
            <option value="Europe/London">ğŸ‡¬ğŸ‡§ ì˜êµ­ (ëŸ°ë˜)</option>
            <option value="Europe/Paris">ğŸ‡«ğŸ‡· í”„ë‘ìŠ¤ (íŒŒë¦¬)</option>
            <option value="Australia/Sydney">ğŸ‡¦ğŸ‡º í˜¸ì£¼ (ì‹œë“œë‹ˆ)</option>
            <option value="UTC">ğŸŒ í˜‘ì •ì„¸ê³„ì‹œ (UTC)</option>
        </select>
        <div class="mt-2 text-sm text-gray-600">
            ğŸŒ íƒœì–´ë‚œ ê³³ì˜ í˜„ì§€ ì‹œê°„ëŒ€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”. ì‚¬ì£¼ ê³„ì‚°ì˜ ì •í™•ë„ì— ì˜í–¥ì„ ì¤ë‹ˆë‹¤.
        </div>
    </div>

    <button type="submit" class="w-full py-5 mt-8 bg-gradient-to-r from-purple-700 to-purple-500 text-white rounded-xl text-lg font-semibold hover:shadow-xl hover:-translate-y-1 transition-transform duration-200">
      ğŸ”® ìš´ì„¸ ë³´ëŸ¬ê°€ê¸°
    </button>
  </form>
</div>

  </div>
<div class="fixed inset-0 bg-white bg-opacity-90 z-50 hidden flex-col justify-center items-center" id="loadingOverlay">
  <div class="w-16 h-16 border-4 border-purple-200 border-t-purple-700 rounded-full animate-spin"></div>
  <div class="mt-4 text-lg text-purple-700 text-center">
    ë‹¹ì‹ ì˜ ìš´ëª…ì„ í•´ì„í•˜ëŠ” ì¤‘ì´ì—ìš”... ğŸ”®<br>ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš” ğŸ™
  </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
// í¼ ì œì¶œ ì‹œ ì¶œìƒì‹œê°„ ì²´í¬ ë° ë¡œë”© í‘œì‹œ (í†µí•©)
document.getElementById('sajuForm').addEventListener('submit', function(e) {
    const birthHourValue = document.getElementById('birthhourSelect').value;
    const hourUnknownChecked = document.getElementById('hourUnknown').checked;

    if (!birthHourValue && !hourUnknownChecked) {
        e.preventDefault();
        alert("ì¶œìƒ ì‹œê°„ì„ ì„ íƒí•˜ê±°ë‚˜ 'ëª¨ë¥´ê² ì–´ìš”'ë¥¼ ì²´í¬í•´ì£¼ì„¸ìš”.");
    } else {
        document.getElementById('loadingOverlay').style.display = 'flex';
    }
});

// ìƒë…„ì›”ì¼ ìœ íš¨ì„± ê²€ì‚¬ (ê¸°ì¡´ ì½”ë“œ ìœ ì§€)
function updateDays() {
    const year = parseInt(document.getElementById('birthYear').value);
    const month = parseInt(document.getElementById('birthMonth').value);
    const daySelect = document.getElementById('birthDay');
    
    if (!year || !month) return;
    
    const daysInMonth = new Date(year, month, 0).getDate();
    const currentDay = daySelect.value;
    
    daySelect.innerHTML = '<option value="">ì¼</option>';
    for (let i = 1; i <= daysInMonth; i++) {
        const selected = (i == currentDay) ? 'selected' : '';
        daySelect.innerHTML += `<option value="${i}" ${selected}>${i}ì¼</option>`;
    }
}

document.getElementById('birthYear').addEventListener('change', updateDays);
document.getElementById('birthMonth').addEventListener('change', updateDays);

// í˜ì´ì§€ ë¡œë“œ ì‹œ ê¸°ë³¸ê°’ ì„¤ì •
window.addEventListener('DOMContentLoaded', function() {
  updateDays();
});

// ìë™ ì‹œê°„ëŒ€ ê°ì§€
document.addEventListener('DOMContentLoaded', function() {
    try {
        const userTimeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;
        const timezoneSelect = document.getElementById('timezoneSelect');
        
        // ì‚¬ìš©ìì˜ ì‹œê°„ëŒ€ê°€ ì˜µì…˜ì— ìˆìœ¼ë©´ ìë™ ì„ íƒ
        for (let option of timezoneSelect.options) {
            if (option.value === userTimeZone) {
                option.selected = true;
                break;
            }
        }
    } catch (e) {
        console.log('ì‹œê°„ëŒ€ ìë™ ê°ì§€ ì‹¤íŒ¨:', e);
    }
});

// ì‹œê°„ ë¯¸ìƒ ì²´í¬ë°•ìŠ¤ ì²˜ë¦¬
document.getElementById('hourUnknown').addEventListener('change', function() {
    const birthhourSelect = document.getElementById('birthhourSelect');
    if (this.checked) {
        birthhourSelect.disabled = true;
        birthhourSelect.value = '';
        birthhourSelect.style.opacity = '0.5';
    } else {
        birthhourSelect.disabled = false;
        birthhourSelect.style.opacity = '1';
    }
});

// ë‹¬ë ¥ ì„ íƒì— ë”°ë¥¸ ì•ˆë‚´ ë©”ì‹œì§€
document.querySelectorAll('input[name="calendar"]').forEach(radio => {
    radio.addEventListener('change', function() {
        const infoDiv = document.getElementById('calendarInfo') || createCalendarInfo();
        
        if (this.value === 'LUN') {
            infoDiv.innerHTML = `
                <div class="mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                    <div class="flex items-center">
                        <span class="text-blue-600 mr-2">â„¹ï¸</span>
                        <span class="text-sm text-blue-800">
                            <strong>ìŒë ¥ ì„ íƒ:</strong> ì „í†µ ìŒë ¥ ë‚ ì§œë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”. 
                            ìë™ìœ¼ë¡œ ì–‘ë ¥ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ê³„ì‚°í•©ë‹ˆë‹¤.
                        </span>
                    </div>
                </div>
            `;
        } else {
            infoDiv.innerHTML = `
                <div class="mt-3 p-3 bg-green-50 border border-green-200 rounded-lg">
                    <div class="flex items-center">
                        <span class="text-green-600 mr-2">âœ…</span>
                        <span class="text-sm text-green-800">
                            <strong>ì–‘ë ¥ ì„ íƒ:</strong> ì¼ë°˜ì ì¸ ë‹¬ë ¥ì˜ ë‚ ì§œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.
                        </span>
                    </div>
                </div>
            `;
        }
    });
});
function createCalendarInfo() {
    const infoDiv = document.createElement('div');
    infoDiv.id = 'calendarInfo';
    const calendarSection = document.querySelector('input[name="calendar"]').closest('.mb-6');
    calendarSection.appendChild(infoDiv);
    return infoDiv;
}
</script>
{% endblock %}