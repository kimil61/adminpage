<!-- templates/enhanced_report_base.html -->
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ user_name }}ë‹˜ì˜ í”„ë¦¬ë¯¸ì—„ ì‚¬ì£¼íŒ”ì ë¦¬í¬íŠ¸</title>
    <style>
        body {
            font-family: 'Noto Sans KR', 'Malgun Gothic', sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            color: #333;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }
        
        .report-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .cover-page {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
        }
        
        .cover-page::before {
            content: 'âœ¨';
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 30px;
            opacity: 0.7;
        }
        
        .cover-page::after {
            content: 'ğŸ”®';
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 30px;
            opacity: 0.7;
        }
        
        .cover-title {
            font-size: 32px;
            font-weight: bold;
            margin: 0 0 10px 0;
        }
        
        .cover-subtitle {
            font-size: 18px;
            opacity: 0.9;
            margin: 0 0 30px 0;
        }
        
        .content-section {
            padding: 30px 40px;
        }
        
        .section-header {
            display: flex;
            align-items: center;
            margin: 40px 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 3px solid #8B5CF6;
        }
        
        .section-icon {
            font-size: 28px;
            margin-right: 15px;
        }
        
        .section-title {
            font-size: 24px;
            font-weight: bold;
            color: #7C3AED;
            margin: 0;
        }
        
        .info-card {
            background: #FFF7ED;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            border-left: 5px solid #8B5CF6;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        
        .pillars-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .pillars-table th {
            background: linear-gradient(135deg, #8B5CF6, #7C3AED);
            color: white;
            padding: 15px;
            font-weight: bold;
            text-align: center;
        }
        
        .pillars-table td {
            padding: 20px;
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            border: 1px solid #E5E7EB;
            background: white;
        }
        
        .pillars-table .day-pillar {
            background: linear-gradient(135deg, #E8F2FF, #F0F9FF) !important;
            color: #1E40AF;
        }
        
        .chart-container {
            text-align: center;
            margin: 25px 0;
        }
        
        .chart-container img {
            max-width: 100%;
            height: auto;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .calendar-wrapper {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        
        .mini-cal {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        .mini-cal th, .mini-cal td {
            padding: 12px 8px;
            text-align: center;
            font-size: 13px;
            border: 1px solid #D1D5DB;
        }
        
        .mini-cal th {
            background: linear-gradient(135deg, #F3F4F6, #E5E7EB);
            font-weight: bold;
            color: #374151;
        }
        
        .checklist-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        
        .checklist-table th {
            background: linear-gradient(135deg, #059669, #047857);
            color: white;
            padding: 15px;
            font-weight: bold;
        }
        
        .checklist-table td {
            padding: 15px;
            border: 1px solid #E5E7EB;
            background: white;
        }
        
        .checklist-table tr:nth-child(even) td {
            background: #F9FAFB;
        }
        
        .ai-analysis {
            background: linear-gradient(135deg, #F0F9FF, #E0F2FE);
            border-left: 5px solid #0EA5E9;
            padding: 30px;
            margin: 25px 0;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        
        .ai-analysis h3 {
            color: #0F172A;
            margin-top: 0;
            display: flex;
            align-items: center;
        }
        
        .ai-analysis h3::before {
            content: 'ğŸ¤–';
            margin-right: 10px;
            font-size: 24px;
        }
        
        .footer-section {
            background: linear-gradient(135deg, #1F2937, #374151);
            color: white;
            padding: 30px 40px;
            text-align: center;
        }
        
        .footer-section h3 {
            margin: 0 0 15px 0;
            font-size: 20px;
        }
        
        .footer-section p {
            margin: 5px 0;
            opacity: 0.9;
        }
        
        .divider {
            height: 3px;
            background: linear-gradient(90deg, #8B5CF6, #06B6D4, #10B981);
            margin: 30px 0;
        }
        
        .highlight-box {
            background: linear-gradient(135deg, #FEF3C7, #FDE68A);
            border: 2px solid #F59E0B;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        .highlight-box h4 {
            color: #92400E;
            margin: 0 0 10px 0;
            font-size: 18px;
        }
        
        /* í”„ë¦°íŠ¸ ìµœì í™” */
        @media print {
            body { background: white; padding: 0; }
            .report-container { box-shadow: none; }
            .section-header { page-break-after: avoid; }
            .info-card { page-break-inside: avoid; }
        }
    </style>
</head>
<body>
    <div class="report-container">
        <!-- ì»¤ë²„ í˜ì´ì§€ -->
        <div class="cover-page">
            <h1 class="cover-title">ğŸ”® í”„ë¦¬ë¯¸ì—„ ì‚¬ì£¼ ë¦¬í¬íŠ¸</h1>
            <p class="cover-subtitle">AI ì‹¬ì¸µ ë¶„ì„ + ì „í†µ ëª…ë¦¬í•™ í•´ì„</p>
            {% if executive_summary %}
                {{ executive_summary|safe }}
            {% endif %}
        </div>

        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <div class="content-section">
            
            <!-- ì‚¬ì£¼íŒ”ì ê¸°ë³¸ ì •ë³´ -->
            {% if pillars %}
            <div class="section-header">
                <span class="section-icon">ğŸ“…</span>
                <h2 class="section-title">ì‚¬ì£¼íŒ”ì ì •ë³´</h2>
            </div>
            
            <div class="info-card">
                <h3 style="margin: 0 0 20px 0; color: #7C3AED;">ë„¤ ê¸°ë‘¥ (å››æŸ±)</h3>
                <table class="pillars-table">
                    <tr>
                        <th>ë…„ì£¼ (å¹´æŸ±)</th>
                        <th>ì›”ì£¼ (æœˆæŸ±)</th>
                        <th>ì¼ì£¼ (æ—¥æŸ±)</th>
                        <th>ì‹œì£¼ (æ™‚æŸ±)</th>
                    </tr>
                    <tr>
                        <td>{{ pillars.year }}</td>
                        <td>{{ pillars.month }}</td>
                        <td class="day-pillar">{{ pillars.day }}</td>
                        <td>{{ pillars.hour }}</td>
                    </tr>
                </table>
                <div class="highlight-box">
                    <h4>ğŸ¯ í•µì‹¬ í¬ì¸íŠ¸</h4>
                    <p>ì¼ì£¼ <strong>{{ pillars.day }}</strong>ê°€ ë‹¹ì‹ ì˜ ë³¸ì§ˆì  ì„±í–¥ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤</p>
                </div>
            </div>
            {% endif %}

            <!-- ìš´ì„¸ ìš”ì•½ -->
            {% if fortune_summary %}
            {{ fortune_summary|safe }}
            {% endif %}

            <div class="divider"></div>

            <!-- ì˜¤í–‰ ë°¸ëŸ°ìŠ¤ ë¶„ì„ -->
            {% if radar_base64 %}
            <div class="section-header">
                <span class="section-icon">âš–ï¸</span>
                <h2 class="section-title">ì˜¤í–‰ ë°¸ëŸ°ìŠ¤ ë¶„ì„</h2>
            </div>
            
            <div class="info-card">
                <div class="chart-container">
                    <img src="{{ radar_base64 }}" alt="ì˜¤í–‰ ë°¸ëŸ°ìŠ¤ ì°¨íŠ¸">
                </div>
                
                {% if elem_dict_kr %}
                <div style="margin-top: 20px;">
                    <h4 style="color: #7C3AED; margin-bottom: 15px;">ğŸ“Š ì„¸ë¶€ ë¶„í¬</h4>
                    <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px;">
                        {% for element, count in elem_dict_kr.items() %}
                        <div style="text-align: center; padding: 15px; background: #F8FAFC; border-radius: 8px; border: 2px solid #E2E8F0;">
                            <div style="font-size: 24px; margin-bottom: 5px;">
                                {% if element == 'ëª©' %}ğŸŒ³{% elif element == 'í™”' %}ğŸ”¥{% elif element == 'í† ' %}ğŸŒ{% elif element == 'ê¸ˆ' %}âš¡{% else %}ğŸ’§{% endif %}
                            </div>
                            <strong style="color: #374151;">{{ element }}</strong><br>
                            <span style="font-size: 18px; font-weight: bold; color: #7C3AED;">{{ count }}ê°œ</span>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>
            {% endif %}

            <div class="divider"></div>

            <!-- 2025ë…„ ì›”ë³„ ìš´ì„¸ -->
            {% if calendar_html %}
            <div class="section-header">
                <span class="section-icon">ğŸ“…</span>
                <h2 class="section-title">2025ë…„ ì›”ë³„ ìš´ì„¸ ìº˜ë¦°ë”</h2>
            </div>
            
            <div class="info-card">
                <div class="calendar-wrapper">
                    {{ calendar_html|safe }}
                    <div style="margin-top: 20px; padding: 15px; background: #F3F4F6; border-radius: 8px;">
                        <strong style="color: #374151;">ğŸ” ìš´ì„¸ ì½ëŠ” ë²•:</strong>
                        <div style="margin-top: 10px; display: flex; justify-content: space-around; font-size: 14px;">
                            <span style="color: #059669;"><strong>â— ì¢‹ìŒ:</strong> ì ê·¹ ì¶”ì§„</span>
                            <span style="color: #D97706;"><strong>â–² ì£¼ì˜:</strong> ì‹ ì¤‘í•˜ê²Œ</span>
                            <span style="color: #DC2626;"><strong>â–  ì¡°ì‹¬:</strong> ë³´ìˆ˜ì ìœ¼ë¡œ</span>
                            <span style="color: #6B7280;"><strong>â—‹ í‰ìƒ:</strong> í˜„ìƒìœ ì§€</span>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}

            <div class="divider"></div>

            <!-- í–‰ìš´ í‚¤ì›Œë“œ -->
            {% if keyword_html %}
            <div class="section-header">
                <span class="section-icon">ğŸ€</span>
                <h2 class="section-title">2025ë…„ í–‰ìš´ í‚¤ì›Œë“œ</h2>
            </div>
            {{ keyword_html|safe }}
            {% endif %}

            <div class="divider"></div>

            <!-- ì‹¤ì²œ ì²´í¬ë¦¬ìŠ¤íŠ¸ -->
            {% if checklist %}
            <div class="section-header">
                <span class="section-icon">âœ…</span>
                <h2 class="section-title">ë§ì¶¤í˜• ì‹¤ì²œ ê°€ì´ë“œ</h2>
            </div>
            
            <div class="info-card">
                <h3 style="margin: 0 0 20px 0; color: #059669;">ğŸ¯ 30ì¼ ì‹¤ì²œ ì²´í¬ë¦¬ìŠ¤íŠ¸</h3>
                <table class="checklist-table">
                    <tr>
                        <th style="width: 20%;">ì¹´í…Œê³ ë¦¬</th>
                        <th style="width: 65%;">ì‹¤ì²œ í•­ëª©</th>
                        <th style="width: 15%;">ì™„ë£Œ</th>
                    </tr>
                    {% for item in checklist %}
                    <tr>
                        <td style="font-weight: bold; color: #059669;">{{ item.cat }}</td>
                        <td style="text-align: left;">{{ item.action }}</td>
                        <td style="text-align: center; font-size: 20px;">â˜</td>
                    </tr>
                    {% endfor %}
                </table>
                <div style="margin-top: 15px; padding: 15px; background: #ECFDF5; border-radius: 8px; border-left: 4px solid #10B981;">
                    <p style="margin: 0; font-size: 14px; color: #065F46;">
                        <strong>ğŸ’¡ í™œìš© íŒ:</strong> ë¦¬í¬íŠ¸ë¥¼ ì¸ì‡„í•˜ì—¬ ì²´í¬ë°•ìŠ¤ë¥¼ í•˜ë‚˜ì”© ì²´í¬í•´ë³´ì„¸ìš”! 
                        ì‘ì€ ì‹¤ì²œì´ í° ë³€í™”ë¥¼ ë§Œë“­ë‹ˆë‹¤.
                    </p>
                </div>
            </div>
            {% endif %}

            <div class="divider"></div>

            <!-- AI ì‹¬ì¸µ ë¶„ì„ -->
            {% if analysis_result %}
            <div class="section-header">
                <span class="section-icon">ğŸ¤–</span>
                <h2 class="section-title">AI ì‹¬ì¸µ í•´ì„</h2>
            </div>
            
            <div class="ai-analysis">
                <h3>ì „ë¬¸ê°€ê¸‰ AI ë¶„ì„ ê²°ê³¼</h3>
                <div style="font-size: 16px; line-height: 1.8;">
                    {{ analysis_result|safe }}
                </div>
            </div>
            {% endif %}

        </div>

        <!-- í‘¸í„° -->
        <div class="footer-section">
            <h3>ğŸ”® ê°ì‚¬í•©ë‹ˆë‹¤!</h3>
            <p><strong>ğŸ“ ê¶ê¸ˆí•œ ì ì´ ìˆìœ¼ì‹œë©´ ì–¸ì œë“  ì—°ë½ì£¼ì„¸ìš”</strong></p>
            <p>ë³¸ ë¦¬í¬íŠ¸ëŠ” AI ë¶„ì„ê³¼ ì „í†µ ëª…ë¦¬í•™ì„ ê²°í•©í•œ ê²°ê³¼ì´ë©°, ì°¸ê³ ìš©ìœ¼ë¡œ í™œìš©í•´ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.</p>
            <p style="font-size: 12px; margin-top: 20px; opacity: 0.7;">
                Â© 2025 SkyLoom | ìƒì„±ì¼: {{ "now"|strftime("%Yë…„ %mì›” %dì¼ %Hì‹œ %Më¶„") }}
            </p>
            <div style="margin-top: 15px; font-size: 14px;">
                <span style="margin: 0 10px;">âœ¨</span>
                <span style="margin: 0 10px;">ğŸ”®</span>
                <span style="margin: 0 10px;">ğŸŒŸ</span>
                <span style="margin: 0 10px;">ğŸ’«</span>
                <span style="margin: 0 10px;">â­</span>
            </div>
        </div>
    </div>
</body>
</html>